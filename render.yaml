services:
  - type: web
    name: graff-demo
    env: python
    region: oregon
    plan: free
    buildCommand: pip install fastapi==0.115.0 uvicorn[standard]==0.30.6 pydantic==2.9.2 jsonschema==4.23.0 python-multipart==0.0.9 openai==1.54.3 python-dotenv==1.0.0 tenacity==8.2.3 python-docx==1.1.2 pypdf2==3.0.1 && python -c "from src.db import init_database; init_database()"
    startCommand: uvicorn src.app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health
    envVars:
      - key: OPENAI_API_KEY
        sync: false  # Set this in Render Dashboard
      - key: OPENAI_MODEL
        sync: false  # Set this in Render Dashboard
      - key: USE_ACTUAL_LLM
        sync: false  # Set this in Render Dashboard
      - key: LOG_LEVEL
        value: "INFO"
      - key: OPENAI_TIMEOUT
        value: "600"  # Longer timeout for large chapters
